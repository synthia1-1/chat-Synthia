<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Synthia Chat</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #ece5dd;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .chat-container {
      width: 100%;
      max-width: 500px;
      height: 100vh;
      background: #fff;
      display: flex;
      flex-direction: column;
    }
    .chat-header {
      background: #075E54;
      color: #fff;
      padding: 15px;
      display: flex;
      align-items: center;
    }
    .chat-header .status {
      font-size: 12px;
      margin-left: 10px;
    }
    .chat-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      background: #ece5dd;
    }
    .bubble {
      max-width: 75%;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 10px;
      line-height: 1.4;
      animation: fadeIn 0.3s ease;
    }
    .bubble.them {
      background: #fff;
      align-self: flex-start;
      border: 1px solid #ccc;
    }
    .bubble.me {
      background: #dcf8c6;
      align-self: flex-end;
    }
    .chat-input {
      display: flex;
      padding: 10px;
      background: #f0f0f0;
    }
    .chat-input input {
      flex: 1;
      padding: 10px;
      border-radius: 20px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    .chat-input button {
      background: #075E54;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      margin-left: 5px;
      cursor: pointer;
    }
    .options {
      display: flex;
      flex-direction: column;
      margin: 10px 0;
    }
    .option-btn {
      background: #dcf8c6;
      border: none;
      padding: 10px;
      margin-top: 5px;
      border-radius: 10px;
      cursor: pointer;
      text-align: left;
    }
    .chat-photo {
      max-width: 200px;
      border-radius: 10px;
    }
    .cta-bar {
      display: none;
      padding: 15px;
      text-align: center;
    }
    .cta-bar a {
      background: #25D366;
      color: #fff;
      text-decoration: none;
      padding: 12px 20px;
      border-radius: 25px;
      font-weight: bold;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }
  </style>

  <!-- Meta Pixel Code -->
  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '632209706612628');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=632209706612628&ev=PageView&noscript=1"
  /></noscript>
  <!-- End Meta Pixel Code -->
</head>
<body>
  <div class="chat-container">
    <div class="chat-header">
      <div class="profile-pic">S</div>
      <div>
        <div>Synthia</div>
        <div class="status" id="status">digitando...</div>
      </div>
    </div>
    <div class="chat-messages" id="chat"></div>
    <div class="chat-input" id="inputBar">
      <input type="text" id="input" placeholder="Digite seu nome...">
      <button id="sendBtn">âž¤</button>
    </div>
    <div class="cta-bar" id="ctaBar">
      <a href="https://pay.kirvano.com/8a41c662-4338-4cca-a14d-256db597d25e" id="checkoutBtn" target="_blank">ðŸ”¥ Liberar ConteÃºdo ðŸ”¥</a>
    </div>
  </div>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('sendBtn');
    const inputBar = document.getElementById('inputBar');
    const ctaBar = document.getElementById('ctaBar');
    const statusEl = document.getElementById('status');
    const checkoutBtn = document.getElementById('checkoutBtn');
    let userName = "";

    function addBubble(sender, text, isHTML=false){
      const bubble = document.createElement('div');
      bubble.classList.add('bubble', sender);
      bubble.innerHTML = isHTML ? text : text;
      chat.appendChild(bubble);
      chat.scrollTop = chat.scrollHeight;
    }

    function showTyping(delay=1500){
      return new Promise(resolve=>{
        statusEl.textContent = 'digitando...';
        setTimeout(()=>{
          statusEl.textContent = 'online';
          resolve();
        }, delay);
      });
    }

    async function startChat(){
      await showTyping();
      addBubble('them','Oi, prazer, eu sou a Synthia ðŸ˜˜ Qual o seu nome?');
    }

    function handleUserName(){
      userName = input.value.trim();
      if(userName){
        addBubble('me', userName);
        input.value='';
        input.disabled=true;
        sendBtn.style.display='none';
        fbq('track', 'Lead'); // ðŸ”¥ Evento de lead
        askPhoto();
      }
    }

    async function askPhoto(){
      await showTyping();
      addBubble('them',`E se eu te mandasse uma foto minha agoraâ€¦ vocÃª bateria uma pra mim? ðŸ”¥`);
      showOptions([
        {text:'Sim, quero ver ðŸ”¥', action: ()=>sendPhoto('sim')},
        {text:'Melhor nÃ£o ðŸ˜…', action: ()=>sendPhoto('nao')}
      ]);
    }

    function showOptions(options){
      const wrapper = document.createElement('div');
      wrapper.classList.add('options');
      options.forEach(opt=>{
        const btn = document.createElement('button');
        btn.classList.add('option-btn');
        btn.textContent = opt.text;
        btn.onclick = ()=>{
          addBubble('me', opt.text);
          wrapper.remove();
          opt.action();
        };
        wrapper.appendChild(btn);
      });
      chat.appendChild(wrapper);
      chat.scrollTop = chat.scrollHeight;
    }

    async function sendPhoto(option){
      if(option==='sim'){
        await showTyping();
        addBubble('them',`<img src="https://i.postimg.cc/L4YPh8xj/Foto2.jpg" class="chat-photo">`,true);
      } else {
        await showTyping();
        addBubble('them','Ok, talvez na prÃ³xima ðŸ˜‰');
      }
      await showTyping();
      addBubble('them',`Nossa, ${userName}â€¦ fiquei toda molhadinha sÃ³ de imaginar vocÃª comigo ðŸ˜ˆðŸ’¦ nÃ£o perde tempoâ€¦ clica abaixo e vem me ter de verdade agora mesmo ðŸ”¥`);
      ctaBar.style.display='block';
      statusEl.textContent = 'online';
    }

    sendBtn.addEventListener('click', handleUserName);
    input.addEventListener('keypress',(e)=>{ if(e.key==='Enter') handleUserName(); });

    checkoutBtn.addEventListener('click', () => {
      fbq('track', 'InitiateCheckout'); // ðŸ”¥ Evento de checkout
    });

    startChat();
  </script>
</body>
</html>
